function cbn(frame) {
document.getElementById("cbn_step").innerHTML = frame;
document.getElementById("cbn_graph").innerHTML = '<img src=\'output/head-map-repeat/file' + frame.toString() + '.png\'>';
if(frame == 0) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span>";
document.getElementById("cbn_term").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;(<span style=\"color: darkblue;\">map</span>&nbsp;(\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span>)&nbsp;(<span style=\"color: darkblue;\">repeat</span>&nbsp;(10&nbsp;+&nbsp;1)))";
document.getElementById("cbn_status").innerHTML = "next step: apply&nbsp;<span style=\"color: darkblue;\">head</span>";
}
if(frame == 1) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span>";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;(\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span>)&nbsp;(<span style=\"color: darkblue;\">repeat</span>&nbsp;(10&nbsp;+&nbsp;1))&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: apply&nbsp;<span style=\"color: darkblue;\">map</span>";
}
if(frame == 2) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span>";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;(\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})&nbsp;(<span style=\"color: darkblue;\">repeat</span>&nbsp;(10&nbsp;+&nbsp;1))&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: beta&nbsp;reduction";
}
if(frame == 3) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span>";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;(<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;(10&nbsp;+&nbsp;1)&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{&nbsp;[]&nbsp;-&gt;&nbsp;[]&nbsp;;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;})&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: apply&nbsp;<span style=\"color: darkblue;\">repeat</span>";
}
if(frame == 4) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;+&nbsp;1";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;(<span style=\"font-weight: bold;\">case</span>&nbsp;(<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;x_1&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_1&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span>)&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{&nbsp;[]&nbsp;-&gt;&nbsp;[]&nbsp;;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;})&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: allocate";
}
if(frame == 5) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;+&nbsp;1";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;(<span style=\"font-weight: bold;\">case</span>&nbsp;(x_1&nbsp;:&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;x_1)&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{&nbsp;[]&nbsp;-&gt;&nbsp;[]&nbsp;;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;f_0&nbsp;<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;})&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: match&nbsp;<span style=\"color: darkred;\">Cons</span>";
}
if(frame == 6) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;+&nbsp;1";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;(<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;f_0&nbsp;x_1&nbsp;<span style=\"font-weight: bold;\">in</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;f_0&nbsp;(<span style=\"color: darkblue;\">repeat</span>&nbsp;x_1))&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: allocate";
}
if(frame == 7) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;+&nbsp;1";
document.getElementById("cbn_term").innerHTML = "<span style=\"font-weight: bold;\">case</span>&nbsp;(f_0&nbsp;x_1&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;f_0&nbsp;(<span style=\"color: darkblue;\">repeat</span>&nbsp;x_1))&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>}";
document.getElementById("cbn_status").innerHTML = "next step: match&nbsp;<span style=\"color: darkred;\">Cons</span>";
}
if(frame == 8) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;+&nbsp;1";
document.getElementById("cbn_term").innerHTML = "f_0&nbsp;x_1";
document.getElementById("cbn_status").innerHTML = "next step: apply&nbsp;f_0";
}
if(frame == 9) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;+&nbsp;1";
document.getElementById("cbn_term").innerHTML = "x_1&nbsp;+&nbsp;x_1";
document.getElementById("cbn_status").innerHTML = "next step: delta:&nbsp;10&nbsp;+&nbsp;1&nbsp;in&nbsp;[x_1]";
}
if(frame == 10) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11";
document.getElementById("cbn_term").innerHTML = "x_1&nbsp;+&nbsp;x_1";
document.getElementById("cbn_status").innerHTML = "next step: delta:&nbsp;11&nbsp;+&nbsp;11";
}
if(frame == 11) {
document.getElementById("cbn_heap").innerHTML = "<span style=\"color: darkblue;\">head</span>&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">map</span>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">case</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;<span style=\"font-weight: bold;\">of</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>:<span style=\"font-style: italic;\">xs&#39;</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;=&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">fx</span>&nbsp;:&nbsp;<span style=\"color: darkblue;\">map</span>&nbsp;<span style=\"font-style: italic;\">f</span>&nbsp;<span style=\"font-style: italic;\">xs&#39;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><span style=\"color: darkblue;\">repeat</span>&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-weight: bold;\">let</span>&nbsp;<span style=\"font-style: italic;\">xs</span>&nbsp;=&nbsp;<span style=\"color: darkblue;\">repeat</span>&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;<span style=\"font-weight: bold;\">in</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;:&nbsp;<span style=\"font-style: italic;\">xs</span><br>f_0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;\\<span style=\"font-style: italic;\">x</span>&nbsp;-&gt;&nbsp;<span style=\"font-style: italic;\">x</span>&nbsp;+&nbsp;<span style=\"font-style: italic;\">x</span><br>x_1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11";
document.getElementById("cbn_term").innerHTML = "22";
document.getElementById("cbn_status").innerHTML = "whnf";
}
}
var cbn_frame = 0;
function cbnNext() {
cbn(++cbn_frame);
}
function cbnPrev() {
cbn(--cbn_frame);
}
cbn(cbn_frame);
